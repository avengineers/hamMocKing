<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Why HammocKing? &mdash; HammocKing  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="canonical" href="https://avengineers.github.io/hammocking/motivation.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Usecase" href="usecase.html" />
    <link rel="prev" title="Welcome to Hammocking’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> HammocKing
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Why HammocKing?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#unit-testing">Unit testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usecase">Usecase</a></li>
<li class="toctree-l2"><a class="reference internal" href="#without-hammocking">Without HammocKing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#with-hammocking">With HammocKing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#google-test-is-only-the-default">Google Test is only the default.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usecase.html">Usecase</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribution.html">Contribution</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">HammocKing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Why HammocKing?</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/motivation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="why-hammocking">
<h1>Why HammocKing?<a class="headerlink" href="#why-hammocking" title="Permalink to this heading"></a></h1>
<p><strong>HammocKing</strong> automates the generation of mockups of C-code in</p>
<ul class="simple">
<li><p>Google Test/Mock styles</p></li>
</ul>
<p>or mockups, fakes, stubs of the framework of your choice.</p>
<blockquote>
<div><p>=&gt; Ready to unit test of legacy code in under a minute. &lt;=</p>
</div></blockquote>
<section id="unit-testing">
<h2>Unit testing<a class="headerlink" href="#unit-testing" title="Permalink to this heading"></a></h2>
<blockquote>
<div><p>“The absence of <strong>unit tests</strong> may indicate a lack of <strong>maturity in engineering</strong> …”</p>
<p>“…unit tests should be <strong>performed by developers</strong> as soon as a function is coded…”</p>
</div></blockquote>
<p>Source: <a class="reference external" href="https://medium.com/danilo-ferreira/the-absence-of-unit-tests-may-indicate-a-lack-of-maturity-in-engineering-c207bfcd3a2e">https://medium.com/danilo-ferreira/the-absence-of-unit-tests-may-indicate-a-lack-of-maturity-in-engineering-c207bfcd3a2e</a></p>
<p>Prerequisites for a successful process implementation:</p>
<p>Unit testing must be integral part of …</p>
<ul class="simple">
<li><p>Developer’s IDE/Editor</p></li>
<li><p>Build system,</p></li>
<li><p>Continuous Integration system.</p></li>
<li><p>Mature testing framework</p></li>
<li><p>Easy-to-use testing framework</p></li>
<li><p>Well documented testing framework.</p></li>
</ul>
</section>
<section id="usecase">
<h2>Usecase<a class="headerlink" href="#usecase" title="Permalink to this heading"></a></h2>
<p><strong>Problem: Big amount of legacy code base.</strong></p>
<p>This often leads to a very long getting started time before you can write your first unit test.</p>
<p>Why?</p>
<p>(Embedded) software consists of a set of software units.
They share data through interfaces.</p>
<p>“Legacy” code means that code base has grown WITHOUT unit tests.</p>
<p>(At least some of the) units have many interfaces.</p>
<img alt="_images/motivation_1_embedded_software.svg" src="_images/motivation_1_embedded_software.svg" /><p>Let’s isolate unit a to be item-under-test (iut) for unit testing. Such a unit usually consists of one c file. Occassionally it consists of more than one source files.</p>
<img alt="_images/motivation_2_iut_isolated.svg" src="_images/motivation_2_iut_isolated.svg" /></section>
<section id="without-hammocking">
<h2>Without HammocKing<a class="headerlink" href="#without-hammocking" title="Permalink to this heading"></a></h2>
<p>In the language of a C/C++ developer the “required interfaces” are “external dependencies”. So when isolated, these external dependencies which are</p>
<ul class="simple">
<li><p>global variables or</p></li>
<li><p>global functions</p></li>
</ul>
<p>do not exist. You need some “glue code” between your isolated production unit (unit under test) and your test file.</p>
<p>When building the test executable the linker complains about them unless you define them. This you do usually either in the source code of your test file(s) or in dedicated
source files or you dedicate special mock source file(s) for that.</p>
<p>Especially when beginning unit testing of large legacy units never have seen test driven developers’ hands it becomes very tedious to do the manual task of …</p>
<ul class="simple">
<li><p>Filter the linker’s error messages for undefined reference. Then …</p></li>
<li><dl class="simple">
<dt>For each reference …</dt><dd><ul>
<li><p>Search through source code to find the declaration of that reference (symbol)</p></li>
<li><p>Add include of header file where declaration is found to test code</p></li>
<li><p>Convert the declaration to a definition and …</p></li>
<li><p>If the symbol is a function then write the body to establish the data flow between unit under test and test code (so write a mock, stub or fake).</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Below example shows the linker’s output for just 2 undefine references:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gcc -c -g -MMD -o a.c.obj a.c</span>
<span class="go">gcc -c -g -MMD -o a_test.c.obj a_test.c</span>
<span class="go">gcc   -g -o a_test.exe a.c.obj a_test.c.obj</span>
<span class="go">c:/users/manna/scoop/apps/mingw-winlibs-llvm-ucrt/current/bin/../lib/gcc/x86_64-w64-mingw32/12.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: a.c.obj: in function `a_some_func&#39;:</span>
<span class="go">C:\d\repos\hammock\doc\source\usage\examples\one_compile_unit/a.c:6: undefined reference to `b_getX&#39;</span>
<span class="go">c:/users/manna/scoop/apps/mingw-winlibs-llvm-ucrt/current/bin/../lib/gcc/x86_64-w64-mingw32/12.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: C:\d\repos\hammock\doc\source\usage\examples\one_compile_unit/a.c:8: undefined reference to `c_setY&#39;</span>
<span class="go">collect2.exe: error: ld returned 1 exit status</span>
<span class="go">make: *** [makefile:14: a_test.exe] Error 1</span>
<span class="go">PS C:\d\repos\hammock\doc\source\usage\examples\one_compile_unit&gt;</span>
</pre></div>
</div>
<p>Back on the abstract level what the developer manually does is to create such adaptors (Mocks) between production code and test code:</p>
<img alt="_images/motivation_4_iut_harness.svg" src="_images/motivation_4_iut_harness.svg" /><p>The typical mood of a developer who does that is …</p>
<img alt="https://www.nexmo.com/wp-content/uploads/2015/03/Manyellingatcomputer-1.jpg" src="https://www.nexmo.com/wp-content/uploads/2015/03/Manyellingatcomputer-1.jpg" />
</section>
<section id="with-hammocking">
<h2>With HammocKing<a class="headerlink" href="#with-hammocking" title="Permalink to this heading"></a></h2>
<p>Or you let <cite>hammocking</cite> do this tedious job of creating these adaptors:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">PS C:\d\repos\hammock\doc\source\usage\examples\one_compile_unit&gt; make</span>
<span class="go">gcc -c -g -MMD -o a.c.obj a.c</span>
<span class="go">python -m hammocking --source a.c --plink a.c.obj --style plain_c --outdir . -g</span>
<span class="go">INFO: HammocKing: Will create mockup for function b_getX</span>
<span class="go">INFO: HammocKing: Will create mockup for function c_setY</span>
<span class="go">gcc -c -g -MMD -o a_test.c.obj a_test.c</span>
<span class="go">gcc -c -g -MMD -o mockup.c.obj mockup.c</span>
<span class="go">gcc   -g -o a_test.exe a.c.obj a_test.c.obj mockup.c.obj</span>
<span class="go">./a_test.exe</span>
<span class="go">PS C:\d\repos\hammock\doc\source\usage\examples\one_compile_unit&gt;</span>
</pre></div>
</div>
<p>Remark: This means to can directly start with your (first) unit tests for that unit.</p>
<p>Then the mood usually is …</p>
<img alt="https://as2.ftcdn.net/v2/jpg/04/43/94/95/1000_F_443949516_guxeFkk1XEBx6kU2eJJ0NOuw5K3qQ4Y9.jpg" src="https://as2.ftcdn.net/v2/jpg/04/43/94/95/1000_F_443949516_guxeFkk1XEBx6kU2eJJ0NOuw5K3qQ4Y9.jpg" />
</section>
<section id="google-test-is-only-the-default">
<h2>Google Test is only the default.<a class="headerlink" href="#google-test-is-only-the-default" title="Permalink to this heading"></a></h2>
<p>Why is the Google Test (including Google Mock) test framework the default?</p>
<p>See <a class="reference external" href="https://cuhkszlib-xiaoxing.readthedocs.io/en/latest/external/gtest/googletest/docs/FAQ.html">https://cuhkszlib-xiaoxing.readthedocs.io/en/latest/external/gtest/googletest/docs/FAQ.html</a></p>
<p>Mockups, stubs, fakes.</p>
<p>See <a class="reference external" href="https://stackoverflow.com/questions/346372/whats-the-difference-between-faking-mocking-and-stubbing">https://stackoverflow.com/questions/346372/whats-the-difference-between-faking-mocking-and-stubbing</a></p>
<p>Test frameworks.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#C">https://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#C</a></p>
<p>See Mockup styles.</p>
<img alt="_images/motivation_5_style.svg" src="_images/motivation_5_style.svg" /></section>
<section id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Permalink to this heading"></a></h2>
<img alt="_images/motivation_3_r_p_interfaces.svg" src="_images/motivation_3_r_p_interfaces.svg" /></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to Hammocking’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="usecase.html" class="btn btn-neutral float-right" title="Usecase" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, RMT guys.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>